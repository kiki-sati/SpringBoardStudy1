<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.study.ansboard.sqls.MemberMapper">

    <select id="memberLogin" resultType="MemberVO" parameterType="MemberVO">
        /* MemberDAO.memberLogin */
     <![CDATA[
        SELECT MEM_ID   memId
             , MEM_PW   memPw
             , MEM_NAME memName
        FROM tb_member
        WHERE MEM_ID = #{memId}
        ]]>
    </select>

    <select id="memIdCheck" resultType="int" parameterType="String">
        /* MemberDAO.memIdCheck */
     <![CDATA[
        SELECT COUNT(MEM_ID)
        FROM tb_member
        WHERE MEM_ID = #{memId}
        ]]>
    </select>


    <insert id="memberJoin" parameterType="MemberVO">
        /* MemberDAO.memberJoin*/
     <![CDATA[
        INSERT
        INTO tb_member ( MEM_ID
                       , MEM_PW
                       , MEM_NAME
                       , PHONE_NUM
                       , MEM_EMAIL
                       , MEM_REGDATE)
        VALUES ( #{memId}
               , #{memPw}
               , #{memName}
               , #{phoneNum}
               , #{memEmail}
               , NOW())
        ]]>
    </insert>

    <delete id="delete" parameterType="BoardVO">
        DELETE
        FROM tb_board
        WHERE B_NO = #{bNo}
    </delete>

    <update id="keepLogin">
        UPDATE tb_member
        SET session_key   = #{sessionId},
            session_limit = #{sessionLimit}
        WHERE MEM_ID = #{memId}
    </update>

    <select id="checkUserWithSessionKey" resultMap="memberVOResultMap">
        SELECT *
        FROM tb_member
        WHERE session_key = #{value}
    </select>

    <resultMap id="memberVOResultMap" type="MemberVO">
        <id property="memId" column="MEM_ID"/>
        <result property="memPw" column="MEM_PW"/>
        <result property="memName" column="MEM_NAME"/>
        <result property="memEmail" column="MEM_EMAIL"/>
        <result property="memRegDate" column="MEM_REGDATE"/>
        <result property="phoneNum" column="PHONE_NUM"/>
    </resultMap>


</mapper>